<% layout("/layouts/boilerplate") %>

    <body>
        <div class="row">
            <div class="col-8 offset-2">

                <h2>Listing</h2>
            </div>

            <div class="col-6 offset-2">

                <div class="card" style="width: 120vh; margin-bottom: 3rem;">
                    <img src="<%= list.image.url %>" class="card-img-top show-img" alt="showing-image">
                    <div class="card-body">
                        <p class="card-text mt-1 mb-3">
                            <b class="" style="font-size: 20px;">
                                <%= list.title %>
                            </b><br>
                            <%= list.description %> <br>
                                &#8377;<%= list.price.toLocaleString("en-in") %> <br>
                                    <%= list.location %> <br>
                                        <%= list.country %>
                        </p>

                        <div class="buttons">
                            <div class="col-1 ">
                                <form method="get" action="/listings/<%= list._id %>/edit">
                                    <button class="edit-btn">Edit</button>
                                </form>
                            </div>
                            <div class="col-4 offset-2">
                                <form method="post" action="/listings/<%= list._id %>?_method=DELETE">
                                    <button class="delete-btn">Delete</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- adding the form  -->
            <hr>
            <div class="col-8 offset-2">
                <h2>Leave a review</h2>
                <form action="/listings/<%= list._id %>/reviews" method="post" class="needs-validation" novalidate>
                    <div class="mt-3 mb-3">
                        <label for="rating" class="form-label">Rating</label>
                        <input type="range" min="1" max="5" name="review[rating]" id="rating" class="form-control"
                            required>
                    </div>

                    <div class="mt-3 mb-3">
                        <label for="comment" class="form-label">Comment</label>
                        <textarea name="review[comment]" id="comment" class="form-control" required></textarea>
                        <div class="valid-feedback">
                            Review looks Good!
                        </div>
                        <div class="invalid-feedback">
                            Please Write Review
                        </div>
                    </div>
                    <button class="btn btn-outline-dark mt-3 mb-3">Submit</button>
                </form>
            </div>

<hr>
            <div class="col-8 offset-2">
                <h2>All reviews</h2>
                <div class="row">
                <% for(let review of list.reviews){ %>
                    <div class="card review-card col-5 offset-1">
                    <div class="card-body">
                        <h5 class="card-title">Jakka Dimpul</h5>
                        <p class="card-text">
                            <%= review.comment %>
                        </p>
                        <p class="card-text">
                            <%= review.rating %>stars
                        </p>
                        <form method="post" action="/listings/<%= list._id %>/reviews/<%= review._id %>?_method=Delete" >
                        <button class="btn btn-sm btn-dark">Delete</button>
                    </form>
                    </div>
                    </div>
                    
            <% } %>
            </div>
            </div>
        </div>

        </div>
    </body>